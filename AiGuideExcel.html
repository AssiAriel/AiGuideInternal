<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Guide - Excel</title>
    <link rel="icon" href="favicon.png" type="image/png">
    <link rel="stylesheet" href="style.css"> 
</head>

<!----------------------------------------------------------------------------------------------->

<body>
    <p class="TitleHead">AI Guide - Excel</p>  

    <!--- Installations -->
    <p class="TitleList1Blue">Installations</p>
    <ol>
        <!--- L1 -->
        <li>
		<!--- Ollama -->	
		<p class="TitleList2Blue">Ollama - inference locally on CPU (Llama, Qwen and more)</p>
        <ol>
            <!--- L2 -->
 			<li>Ollama Introduction and Installation Video
			<p><a href="https://www.youtube.com/watch?v=1xdneyn6zjw" target="_blank">Link: Run New Llama 3.1 on Your Computer Privately in 10 minutes (Skill Leap AI)</a></p>
  			<img src="images/OllamaInstallSite.png" class="zoomable" ondblclick="this.classList.toggle('full')"">
			<p>Run inference from the terminal or from the Ollama chat.
            <br>Note - the new Ollama installation also installs Ollama Chat, so you don't need to install Docker and so - view the video upto 8:35 only,
            <br> (unless you want to upload files to the model).</p>
 		    </li>

            <!--- L2 -->
 			<li>Ollama Models
     		<p><a href="https://ollama.com/" target="_blank">Link: Run Ollama</a></p>
  			<img src="images/Ollama.png" class="zoomable" ondblclick="this.classList.toggle('full')"">
  	     	<p>Go to Ollama. </p>

  			<img src="images/OllamaRun.png" class="zoomable" ondblclick="this.classList.toggle('full')"">
  	     	<p>Choose a Model and run. </p>

  			<img src="images/OllamaModels.png" class="zoomable" ondblclick="this.classList.toggle('full')"">
  	     	<p>To download another Model. </p>

  			<img src="images/OllamaDownloadModel1.png" class="zoomable" ondblclick="this.classList.toggle('full')"">
  	     	<p>Here. </p>

  			<img src="images/OllamaDownloadModel2.png" class="zoomable" ondblclick="this.classList.toggle('full')"">
  	     	<p>And here. </p>

  			<img src="images/OllamaDownloadModel3.png" class="zoomable" ondblclick="this.classList.toggle('full')"">
  	     	<p>Copy. </p>

  			<img src="images/OllamaDownloadModel4.png" class="zoomable" ondblclick="this.classList.toggle('full')">
  	     	<p>Paste and run.
			<br>Note that in order to run it from the application you need to close and reopen it.</p>
			</li>
			
            <!--- L2 -->
			<li>Ollama running
   			<p></p><img src="images/OllamaCPU40B.png" class="zoomable" ondblclick="this.classList.toggle('full')"></p>
        	<p>Note - if you try a model that is too big for your computer, like 40B in this example, this is what you get.</p>

			<img src="images/OllamaMistral24B.png" class="zoomable" ondblclick="this.classList.toggle('full')">
			<p>When I tried a 24B model on a CPU with 16G RAM I get a lot of Disk usage (I believe swap files):</p>

			<img src="images/OllamaDeleteModel.png" class="zoomable" ondblclick="this.classList.toggle('full')">
   	     	<p>You can remove models from the terminal by "ollama list" and then "ollama rm modelName". </p>
            </li>
        </ol>
        </li>
	
        <!--- L1 -->
        <li>
		<!--- Excel Ribbon -->
		<p class="TitleList2Blue">Excel Ribbon</p>
     	<ol>
            <!--- L2 -->
			<li	>Add Button to the Ribbon
            <ol>
                <!--- L3 -->
                <li>
                Save the Excel file as .xlsm (for now, can be changed to include other types)
				</li>

                <!--- L3 -->
                <li>
                Inside Excel Alt + F1, add:
				<br><pre>Sub LaunchAIExcel()
                <br>    RunPython "import AiExcel_main; AiExcel_main.main()"
                <br>End Sub</pre>
				<br>Actually this is just the simple version, that doesn't always work,
				<br>so copy into it the code from  AIExcel_bridge.bas file,
				<br>for now, until installation is implemented.
				</li>

                <!--- L3 -->
                <li>
                Right click on the Ribbon and "Customize the Ribbon...",
                <br>on the right "New Tab",
                <br>"Rename..." the "New Tab" and the "New Group",
                <br>on the left side change the drop down to "Macros",
                <br>choose LaunchAIExcel and "Add >>" it to your new group,
                <br>"Rename..." it and choose icon
				</li>

                <!--- L3 -->
                <li>
				When you open an Excel file from D: (DevDrive) you will get a "Security Risk Microsoft has blocked macros..."
                <br>this happens only on D:.
                <br>Right click on the Ribbon and "Customize the Ribbon...",
                <br>Inside Excel File -> Options,
                <br>click "Trust Center",
                <br>click "Trust Center Settings...",
                <br>click "Trusted Locations",
                <br>click "Add new location...",
                <br>"Browse..." to D:\Dev\AiExcelProject,
                <br>check "Subfolders of this location are also trusted",
                <br>"OK".
				</li>
			</ol>
		    </li>

            <!--- L2 -->
			<li	>Connect RunPython to Excel
            <ol>
                <!--- L3 -->
                <li>
                Open Terminal in D:\Dev\AiExcelProject,
				<br>go to green .venv, run:
				<br> .\.venv\Scripts\Activate.ps1
                <br>run : xlwings quickstart temp_fix --standalone
				<br>a folder "temp_fix" was created.
				</li>

                <!--- L3 -->
                <li>
                Open the Excel file that is in new folder,
				<br>press Alt + F11
				<br>right click on Module -> xlwings
                <br>"Export File..." and "Save"
				</li>

                <!--- L3 -->
                <li>
                Open AI_Generated_Table.xlsm
                <br>Alt + F11
                <br>right-click VBAProject (I_Generated_Table.xlsm),
                <br>"Import File..." and select xlwings.bas
				<br>delete temp_fix folder and xlwings.bas file.
				</li>
			</ol>
		    </li>
		</ol>
		</li>
    </ol>

<!-- 
			<li	>pyperclip
    		<p>pip install pyperclip</p>
     		<p>Just a copy tool needed sometimes.</p>
		    </li>
-->

</body>
</html>